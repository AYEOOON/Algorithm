"""
β… λ¬Έμ  μ”μ•½
- κ° μ§μ›μ€ ν–‰μ‚¬μ— μ°Έμ„ν•  κ²½μ° κ³ μ ν• λΉ„μ©(sales)μ΄ λ“ λ‹¤.
- μ΅°μ§μ€ νΈλ¦¬ κµ¬μ΅°(links)λ΅ μ£Όμ–΄μ§€λ©°, links[i] = [a, b]λ” aκ°€ μƒμ‚¬μ΄κ³  bκ°€ λ¶€ν•μ„μ„ μλ―Έν•λ‹¤.
- μ΅°κ±΄: μ–΄λ–¤ ν€(=μμ‹μ΄ μλ” λ…Έλ“)μ΄λ“  μµμ†ν• 1λ… μ΄μƒμ€ λ°λ“μ‹ ν–‰μ‚¬μ— μ°Έμ„ν•΄μ•Ό ν•λ‹¤. 
- λ©ν‘: μ΄ μ΅°κ±΄μ„ μ§€ν‚¤λ©΄μ„ ν–‰μ‚¬ μ°Έμ„ λΉ„μ©μ„ μµμ†ν™”ν•λ” κ²ƒμ΄λ‹¤. 

π§© ν•µμ‹¬ μ•„μ΄λ””μ–΄ (νΈλ¦¬ DP)
- dp[i][0]: iλ² λ…Έλ“κ°€ ν–‰μ‚¬μ— λ¶μ°Έν•  λ•μ μµμ† λΉ„μ©
- dp[i][1]: iλ² λ…Έλ“κ°€ ν–‰μ‚¬μ— μ°Έμ„ν•  λ•μ μµμ† λΉ„μ©

  <κ΄€κ³„>
  - μ°Έμ„ν•λ” κ²½μ°: dp[i][1] = sales[i-1] + μμ‹λ“¤μ μµμ† λΉ„μ©
  - λ¶μ°Έν•λ” κ²½μ°: μμ‹λ“¤ μ¤‘ μµμ† 1λ…μ€ λ°λ“μ‹ μ°Έμ„ν•΄μ•Ό ν•λ―€λ΅, μμ™Έ μ²λ¦¬λ¥Ό ν•΄μ¤μ•Ό ν•¨.
"""

from collections import defaultdict

def solution(sales, links):
    n = len(sales)
    tree = defaultdict(list)

    # νΈλ¦¬ κµ¬μ΅° μƒμ„±
    for a, b in links:
        tree[a].append(b)

    # DP ν…μ΄λΈ” μ΄κΈ°ν™”
    # dp[i][0]: iλ² λ…Έλ“κ°€ λ¶μ°Έν–μ„ λ•μ μµμ† λΉ„μ©
    # dp[i][1]: iλ² λ…Έλ“κ°€ μ°Έμ„ν–μ„ λ•μ μµμ† λΉ„μ©
    dp = [[0, 0] for _ in range(n + 1)]
    visited = [False] * (n + 1)

    def dfs(node):
        visited[node] = True
        dp[node][1] = sales[node - 1]  # ν„μ¬ λ…Έλ“κ°€ μ°Έμ„ν•  κ²½μ° λ³ΈμΈμ λΉ„μ©

        # λ¦¬ν”„ λ…Έλ“λ” μμ‹μ΄ μ—†μΌλ―€λ΅ return
        if not tree[node]:
            return

        cost = float('inf')           # μμ‹ μ¤‘ ν•λ‚λ¥Ό μ°Έμ„μ‹ν‚¤κΈ° μ„ν• μ¶”κ°€ λΉ„μ©
        is_all_child_opt_out = True   # λ¨λ“  μμ‹μ΄ λ¶μ°Έν–λ”μ§€ μ—¬λ¶€ μ²΄ν¬

        for child in tree[node]:
            dfs(child)  # μμ‹ λ¨Όμ € μ²λ¦¬

            # ν„μ¬ λ…Έλ“κ°€ μ°Έμ„ν•  κ²½μ°: μμ‹μ€ μ°Έμ„/λ¶μ°Έ μ¤‘ λ” μ‘μ€ λΉ„μ© μ„ νƒ κ°€λ¥
            dp[node][1] += min(dp[child][0], dp[child][1])

            # ν„μ¬ λ…Έλ“κ°€ λ¶μ°Έν•  κ²½μ°: μμ‹λ„ λ¨λ‘ λ¶μ°Έμ΄λ©΄ μ• λ¨
            dp[node][0] += min(dp[child][0], dp[child][1])

            # μμ‹ μ¤‘ ν•λ‚λΌλ„ μ°Έμ„ν•λ©΄ μ΅°κ±΄ λ§μ΅±
            if dp[child][0] > dp[child][1]:
                is_all_child_opt_out = False

            # λ¶μ°Έν• μμ‹λ§ μμ„ κ²½μ°, μ°Έμ„ν• μμ‹ ν•λ‚λ¥Ό κ°•μ λ΅ μ„ νƒν•΄μ•Ό ν•λ―€λ΅ λΉ„μ© κ³„μ‚°
            cost = min(cost, dp[child][1] - dp[child][0])

        # μμ‹μ΄ λ¨λ‘ λ¶μ°Έν• κ²½μ° -> μμ™Έ μ²λ¦¬: μμ‹ ν•λ‚λ” λ°λ“μ‹ μ°Έμ„μ‹μΌμ•Ό ν•¨
        if is_all_child_opt_out:
            dp[node][0] += cost

    # 1λ²μ΄ λ£¨νΈ λ…Έλ“
    dfs(1)

    # λ£¨νΈ λ…Έλ“κ°€ μ°Έμ„/λ¶μ°Έ μ¤‘ λ” μ‘μ€ λΉ„μ©μ„ μ„ νƒ
    return min(dp[1][0], dp[1][1])
